<section class="quiz">
  <header class="quiz__header">
    <div>
      <h1 class="quiz__title">Backend Trivia</h1>
      <p class="quiz__subtitle">Quick backend knowledge checks with four choices and one correct answer.</p>
    </div>
    <button type="button" class="button button--ghost" (click)="quizState.startNewSession()" [disabled]="quizState.isLoading()">
      New session
    </button>
  </header>

  <p *ngIf="quizState.session() as activeSession" class="quiz__meta">Session: {{ activeSession.id }}</p>

  <p *ngIf="quizState.errorMessage() as error" class="quiz__status quiz__status--warning">{{ error }}</p>

  <article *ngIf="quizState.question() as activeQuestion" class="quiz__card">
    <h2 class="quiz__question">{{ activeQuestion.prompt }}</h2>

    <ul class="quiz__options">
      <li *ngFor="let option of activeQuestion.options">
        <button
          type="button"
          class="quiz__option"
          [class.quiz__option--selected]="quizState.selectedOptionId() === option.id"
          (click)="quizState.selectOption(option.id)"
          [disabled]="quizState.isLoading()"
        >
          {{ option.label }}
        </button>
      </li>
    </ul>

    <button type="button" class="button button--primary" (click)="quizState.submitAnswer()" [disabled]="!quizState.canSubmit()">
      Submit answer
    </button>
  </article>

  <section
    *ngIf="quizState.feedback() as result"
    class="quiz__status"
    [class.quiz__status--success]="result.correct"
    [class.quiz__status--error]="!result.correct"
  >
    <p class="quiz__status-title">
      {{ result.correct ? 'Correct!' : 'Incorrect, but keep going.' }}
    </p>
    <p *ngIf="result.explanation" class="quiz__status-body">{{ result.explanation }}</p>
    <button type="button" class="button button--ghost" (click)="quizState.clearFeedback()">Dismiss</button>
  </section>

  <p *ngIf="quizState.isLoading()" class="quiz__status">Loadingâ€¦</p>
</section>
